<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dingin FM â€” CanlÄ± YayÄ±n</title>

<style>
body{
  margin:0;
  min-height:100vh;
  font-family:'Segoe UI',sans-serif;
  text-align:center;
  color:#4fb9ff;

  background:
    url("assets/logo.png") center center / 60% no-repeat,
    radial-gradient(
      circle at center,
      #ffffff 0%,
      #f1f8ff 40%,
      #e3f0ff 70%,
      #d6e9ff 100%
    );
}

/* HEADER */
header{
  padding:28px 10px 18px;
  background:rgba(255,255,255,.75);
  backdrop-filter:blur(6px);
  box-shadow:0 2px 8px rgba(0,0,0,.15);
}

h1{
  margin:0;
  font-size:28px;
  letter-spacing:2px;
}

h2{
  margin:6px 0 0;
  font-size:14px;
  font-weight:400;
  color:#6fc9ff;
}

nav a{
  margin:0 12px;
  font-size:15px;
  text-decoration:none;
  color:#4fb9ff;
}
nav a.active, nav a:hover{ text-decoration:underline; }

/* MAIN */
main{
  max-width:640px;
  margin:50px auto;
  background:rgba(255,255,255,.78);
  backdrop-filter:blur(6px);
  padding:28px;
  border-radius:18px;
  box-shadow:0 6px 18px rgba(0,0,0,.15);
}

/* STATUS */
.status{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:10px;
  margin-bottom:18px;
}
.led{
  width:14px;
  height:14px;
  border-radius:50%;
  background:#aaa;
  box-shadow:0 0 10px currentColor;
}

/* BUTTON */
.button{
  display:inline-block;
  padding:12px 28px;
  border-radius:30px;
  border:2px solid #4fb9ff;
  color:#4fb9ff;
  text-decoration:none;
  font-weight:600;
  cursor:pointer;
  background:transparent;
  transition:.25s;
}
.button:hover{
  background:#4fb9ff;
  color:#fff;
}

/* INFO */
.info{
  font-size:15px;
  color:#5f86a3;
  line-height:1.6;
}

/* FOOTER */
footer{
  margin-top:50px;
  padding:18px;
  font-size:13px;
  color:#6fc9ff;
}
</style>
</head>

<body>

<header>
  <h1>DINGIN FM</h1>
  <h2>SessizliÄŸin Sesi Burada</h2>
  <nav>
    <a href="index.html">Ana Sayfa</a>
    <a href="live.html" class="active">CanlÄ± YayÄ±n</a>
    <a href="dj.html">DJ Aylak</a>
    <a href="podcast.html">Podcast</a>
    <a href="blog.html">Blog</a>
    <a href="connect.html">Ä°letiÅŸim</a>
  </nav>
</header>

<main>

  <div class="status">
    <span id="led" class="led"></span>
    <span id="statusText">Durum kontrol ediliyorâ€¦</span>
  </div>

  <p class="info">
    Dinleyici: <b id="listeners">â€”</b> Â·
    Peak: <b id="peak">â€”</b> Â·
    Bitrate: <b id="bitrate">â€”</b>
  </p>

  <br>

  <button id="playBtn" class="button">â–¶ï¸ YayÄ±nÄ± Dinle</button>

</main>

<footer>
  Â© 2025 Dingin FM â€” SessizliÄŸin Sesi Burada
</footer>

<script>
/* ===== AYARLAR (GERÃ‡EK) ===== */
const STREAM_URL   = "https://dinginfm.com.tr/live.mp3";
const STATUS_URL   = "https://dinginfm.com.tr/status-json.xsl";

/* ===== AUDIO ===== */
let audio = new Audio(STREAM_URL);
audio.preload = "none";

/* ===== ELEMENTLER ===== */
const led        = document.getElementById("led");
const statusText = document.getElementById("statusText");
const playBtn    = document.getElementById("playBtn");
const listeners  = document.getElementById("listeners");
const peak       = document.getElementById("peak");
const bitrate    = document.getElementById("bitrate");

/* ===== YAYIN DURUMU (GERÃ‡EK ICECAST) ===== */
async function checkStatus(){
  try{
    const res = await fetch(STATUS_URL, { cache:"no-store" });
    const data = await res.json();

    let src = data.icestats.source;
    if(Array.isArray(src)) src = src.find(s => s.listenurl?.includes("live"));

    if(src){
      led.style.background = "#2ecc71";
      statusText.textContent = "ğŸŸ¢ YayÄ±nda";
      listeners.textContent = src.listeners;
      peak.textContent = src.listener_peak;
      bitrate.textContent = src.bitrate + " kbps";
    }else{
      throw "YayÄ±n yok";
    }
  }catch(e){
    led.style.background = "#aaa";
    statusText.textContent = "âšª YayÄ±nda DeÄŸil";
    listeners.textContent = "0";
    peak.textContent = "0";
    bitrate.textContent = "â€”";
  }
}

/* ===== PLAY / STOP (GERÃ‡EK) ===== */
playBtn.addEventListener("click", async ()=>{
  if(audio.paused){
    try{
      await audio.play();
      playBtn.textContent = "â¸ YayÄ±nÄ± Durdur";
    }catch(e){
      alert("YayÄ±n baÅŸlatÄ±lamÄ±yor. Sunucu veri gÃ¶ndermiyor olabilir.");
    }
  }else{
    audio.pause();
    playBtn.textContent = "â–¶ï¸ YayÄ±nÄ± Dinle";
  }
});

/* ===== OTOMATÄ°K GÃœNCELLE ===== */
checkStatus();
setInterval(checkStatus, 5000);
</script>

</body>
</html>
