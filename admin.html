<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DinginFM â€” DJ Aylak YÃ¶netim Paneli</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="logo-bg"></div>

<header>
  <h1>ğŸ§ DinginFM â€” DJ Aylak YÃ¶netim Paneli</h1>
  <h2>SessizliÄŸin Sesi Burada</h2>
</header>

<main>
  <section>
    <h3>ğŸ“¡ YayÄ±n Durumu: 
      <span id="status" style="color:#ff6b6b;">OFF AIR</span> | 
      <span id="icecast-status" style="color:#bbb;">BaÄŸlantÄ±: Kontrol ediliyor...</span>
    </h3>
    <p>ğŸ™ï¸ Dinleyici: <span id="listeners">0</span> | Bitrate: 128 kbps | ÅarkÄ±: <span id="currentSong">Belirtilmedi</span></p>

    <div class="panel-buttons">
      <button class="btn" onclick="toggleBroadcast()">YayÄ±nÄ± AÃ§ / Kapat</button>
      <button class="btn" onclick="openIcecast()">Icecast Paneli</button>
      <button class="btn" onclick="window.location.href='live.html'">CanlÄ± YayÄ±n</button>
      <button class="btn" onclick="window.location.href='connect.html'">Dinleyici MesajlarÄ±</button>
      <button class="btn" onclick="window.location.href='podcast.html'">Podcast</button>
      <button class="btn" onclick="window.location.href='dj.html'">DJ SayfasÄ±</button>
      <button class="btn" onclick="window.location.href='tarihce.html'">TarihÃ§e</button>
      <button class="btn" onclick="window.location.href='blog.html'">Blog</button>
    </div>
  </section>

  <section class="stat-box">
    <h3>ğŸ“Š YayÄ±n Ä°statistikleri</h3>
    <table>
      <tr><th>Parametre</th><th>DeÄŸer</th></tr>
      <tr><td>Toplam Dinleyici</td><td id="totalListeners">0</td></tr>
      <tr><td>Peak (En YÃ¼ksek)</td><td id="peakListeners">0</td></tr>
      <tr><td>Toplam SÃ¼re</td><td id="totalHours">0 saat</td></tr>
      <tr><td>Son GÃ¼ncelleme</td><td id="lastUpdate">â€”</td></tr>
    </table>
  </section>

  <section class="message-box">
    <h3>ğŸ’¬ Dinleyici MesajlarÄ±</h3>
    <form onsubmit="simulateNewMessage(event)">
      <input type="text" id="msgName" placeholder="AdÄ±nÄ±z">
      <textarea id="msgText" placeholder="MesajÄ±nÄ±z..."></textarea>
      <button type="submit" class="btn">GÃ¶nder</button>
    </form>
  </section>
</main>

<footer>
  <p>Â© 2025 DinginFM â€” TÃ¼m yayÄ±n ve iÃ§erik haklarÄ± saklÄ±dÄ±r.</p>
</footer>

<audio id="notifySound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_698b8f343e.mp3?filename=notification-1-126505.mp3" preload="auto"></audio>

<script>
let isOnAir = false;
let totalHours = 0;

/* ğŸ”´ğŸŸ¢ BaÄŸlantÄ± kontrolÃ¼ */
async function checkIcecast() {
  const statusEl = document.getElementById("icecast-status");
  try {
    const res = await fetch("http://localhost:8000", { method: "HEAD" });
    if (res.ok) {
      statusEl.textContent = "BaÄŸlantÄ± Aktif ğŸ”µ";
      statusEl.style.color = "#00ff88";
    } else {
      statusEl.textContent = "BaÄŸlantÄ± KapalÄ± ğŸ”´";
      statusEl.style.color = "#ff6b6b";
    }
  } catch (e) {
    statusEl.textContent = "BaÄŸlantÄ± KapalÄ± ğŸ”´";
    statusEl.style.color = "#ff6b6b";
  }
}
setInterval(checkIcecast, 10000); // 10 saniyede bir kontrol et
checkIcecast();

/* ğŸšï¸ YayÄ±n ON/OFF */
function toggleBroadcast() {
  const s = document.getElementById("status");
  if (!isOnAir) {
    s.style.color = "#00ff88";
    s.textContent = "ON AIR";
    simulateListeners();
  } else {
    s.style.color = "#ff6b6b";
    s.textContent = "OFF AIR";
  }
  isOnAir = !isOnAir;
}

/* ğŸ‘‚ Dinleyici sayÄ±sÄ± simÃ¼lasyonu */
function simulateListeners() {
  const l = document.getElementById("listeners");
  const peakEl = document.getElementById("peakListeners");
  const totalEl = document.getElementById("totalListeners");
  const upd = document.getElementById("lastUpdate");
  const hours = document.getElementById("totalHours");

  const count = Math.floor(Math.random() * 30) + 5;
  l.textContent = count;
  peakEl.textContent = Math.max(count, Number(peakEl.textContent));
  totalEl.textContent = Number(totalEl.textContent) + count;
  hours.textContent = (totalHours += 1) + " saat";
  upd.textContent = new Date().toLocaleTimeString("tr-TR");
}

/* ğŸ“© Yeni mesaj geldiÄŸinde ses Ã§al */
function simulateNewMessage(e) {
  e.preventDefault();
  const name = document.getElementById("msgName").value;
  const text = document.getElementById("msgText").value;
  if (name && text) {
    const audio = document.getElementById("notifySound");
    audio.currentTime = 0;
    audio.play();
    alert(`ğŸ“¨ Yeni Mesaj: ${name} - "${text}"`);
    document.getElementById("msgName").value = "";
    document.getElementById("msgText").value = "";
  } else {
    alert("LÃ¼tfen adÄ±nÄ±zÄ± ve mesajÄ±nÄ±zÄ± girin.");
  }
}

/* ğŸ”— Icecast paneli */
function openIcecast() {
  window.open("http://localhost:8000", "_blank");
}
</script>

</body>
</html>
